import{d as $,b as C,e as h,f as u,g as n,u as o,h as F,i as e,j as _,o as d,c as m,t as p,k as c,F as E,l as A,q as B,s as v,x as D,y as I}from"./app-Cnu1gOwx.js";import{_ as L}from"./AppLayout.vue_vue_type_script_setup_true_lang-BsunwvL6.js";import{_ as b}from"./index-ZhNFNWlx.js";import{_ as f}from"./Input.vue_vue_type_script_setup_true_lang-BjujaZ9W.js";import{_ as M}from"./index-B9zbP6Lt.js";import{_ as P}from"./Checkbox.vue_vue_type_script_setup_true_lang-CK8al6tI.js";import"./utils-B2lt5qvW.js";import"./SidebarProvider.vue_vue_type_script_setup_true_lang-D9ELYKiY.js";import"./index-C95YMyaC.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-7KO4OSdx.js";import"./Presence-DsGFcCQD.js";import"./Primitive-DjESCHKf.js";import"./useForwardExpose-BLSp3ctu.js";import"./useForwardPropsEmits-7OYayjxh.js";import"./useBookmarksStore-CqZ8Hg9i.js";import"./RovingFocusGroup-CTM2BYrC.js";import"./NavUser.vue_vue_type_script_setup_true_lang-DpNtjfa_.js";import"./x-DPYUiTTF.js";import"./createLucideIcon-Bcqn1TNB.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-BM8zGcSl.js";import"./VisuallyHidden-DMHoSJ6j.js";import"./DropdownMenuLabel.vue_vue_type_script_setup_true_lang-BsNCB4s2.js";import"./index-BDqSilVs.js";import"./users-BWVYtLU_.js";import"./AppLogo.vue_vue_type_script_setup_true_lang-B5KWgplW.js";import"./panel-left-open-DngcrXPr.js";import"./settings-2-Coye754b.js";import"./SidebarTrigger.vue_vue_type_script_setup_true_lang-Wh4flilG.js";import"./CommandMenu-7__iXElJ.js";import"./DialogContent.vue_vue_type_script_setup_true_lang-BRP34PkQ.js";import"./external-link-Ba6wMvep.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./check-CpI5L1pJ.js";const j={class:"flex flex-col gap-6 px-6 py-6"},q={class:"rounded-xl border bg-card p-4"},T={class:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between"},z={class:"flex flex-col gap-2 sm:flex-row sm:items-center"},Y={class:"flex flex-col gap-2 sm:flex-row"},G={key:0,class:"mt-2 text-xs text-destructive"},H={key:1,class:"mt-2 text-xs text-emerald-600"},J={class:"rounded-xl border bg-card"},K={class:"overflow-x-auto"},O={class:"w-full text-sm"},Q={class:"px-4 py-4"},R={class:"font-medium"},W={class:"text-xs text-muted-foreground"},X={class:"px-4 py-4"},Z={class:"px-4 py-4"},ee={class:"px-4 py-4"},te={class:"px-4 py-4"},se={class:"flex items-center gap-3"},oe={class:"px-4 py-4"},ae={class:"flex flex-col gap-2"},re={class:"flex flex-col gap-2 sm:flex-row sm:items-center"},de={key:0,class:"text-xs text-destructive"},ie={key:1,class:"text-xs text-muted-foreground"},le={key:0},ze=$({__name:"Users",props:{users:{}},setup(k){const w=k,V=[{title:"Admin Settings",href:"/admin/settings"},{title:"User Management",href:"/admin/users"}],U=D(),g=B(()=>U.props.auth?.user?.id),r=C({email:"",name:""}),x=I({}),i=a=>(x[a]||(x[a]={password:"",confirm:""}),x[a]),y=a=>{if(!a)return"—";const t=new Date(a);return Number.isNaN(t.getTime())?"—":t.toLocaleString()},S=(a,t)=>{v.patch(`/admin/users/${a.id}`,{is_admin:t},{preserveScroll:!0,onError:s=>{const l=i(a.id);l.error=s.is_admin||"Failed to update admin status."}})},N=a=>{const t=i(a.id);if(t.error=void 0,!t.password){t.error="Password is required.";return}v.patch(`/admin/users/${a.id}`,{password:t.password,password_confirmation:t.confirm},{preserveScroll:!0,onSuccess:()=>{t.password="",t.confirm=""},onError:s=>{t.error=s.password||s.password_confirmation||"Failed to update password."}})};return(a,t)=>(d(),h(L,{breadcrumbs:V},{default:u(()=>[n(o(F),{title:"User Management"}),e("div",j,[t[9]||(t[9]=e("div",null,[e("h1",{class:"text-3xl font-bold tracking-tight"},"User Management"),e("p",{class:"text-muted-foreground mt-2 max-w-2xl"}," Manage user access, admin roles, and reset passwords. ")],-1)),e("div",q,[e("div",T,[t[4]||(t[4]=e("div",{class:"space-y-1"},[e("h2",{class:"text-base font-semibold"},"Invite a user"),e("p",{class:"text-sm text-muted-foreground"}," Sends a password setup email to the new user. ")],-1)),e("div",z,[e("div",Y,[n(o(f),{modelValue:o(r).name,"onUpdate:modelValue":t[0]||(t[0]=s=>o(r).name=s),placeholder:"Name (optional)",class:"sm:w-48"},null,8,["modelValue"]),n(o(f),{modelValue:o(r).email,"onUpdate:modelValue":t[1]||(t[1]=s=>o(r).email=s),placeholder:"Email address",type:"email",class:"sm:w-56"},null,8,["modelValue"])]),n(o(b),{type:"button",disabled:o(r).processing||!o(r).email,onClick:t[2]||(t[2]=s=>o(r).post("/admin/users/invite",{preserveScroll:!0,onSuccess:()=>o(r).reset()}))},{default:u(()=>[...t[3]||(t[3]=[_(" Send invite ",-1)])]),_:1},8,["disabled"])])]),o(r).errors.email?(d(),m("p",G,p(o(r).errors.email),1)):c("",!0),o(r).recentlySuccessful?(d(),m("p",H," Invite sent. ")):c("",!0)]),e("div",J,[e("div",K,[e("table",O,[t[8]||(t[8]=e("thead",{class:"border-b text-left text-muted-foreground"},[e("tr",null,[e("th",{class:"px-4 py-3 font-medium"},"User"),e("th",{class:"px-4 py-3 font-medium"},"Email"),e("th",{class:"px-4 py-3 font-medium"},"Created"),e("th",{class:"px-4 py-3 font-medium"},"Last Login"),e("th",{class:"px-4 py-3 font-medium"},"Admin"),e("th",{class:"px-4 py-3 font-medium"},"Password")])],-1)),e("tbody",null,[(d(!0),m(E,null,A(w.users,s=>(d(),m("tr",{key:s.id,class:"border-b last:border-b-0"},[e("td",Q,[e("div",R,p(s.name),1),e("div",W,"ID "+p(s.id),1)]),e("td",X,p(s.email),1),e("td",Z,p(y(s.created_at)),1),e("td",ee,p(y(s.last_login_at)),1),e("td",te,[e("div",se,[n(o(P),{checked:s.is_admin,disabled:g.value===s.id&&s.is_admin,"onUpdate:checked":l=>S(s,l)},null,8,["checked","disabled","onUpdate:checked"]),s.is_admin?(d(),h(o(M),{key:0,variant:"secondary"},{default:u(()=>[...t[5]||(t[5]=[_("Admin",-1)])]),_:1})):c("",!0)])]),e("td",oe,[e("div",ae,[e("div",re,[n(o(f),{modelValue:i(s.id).password,"onUpdate:modelValue":l=>i(s.id).password=l,type:"password",placeholder:"New password",class:"sm:w-48"},null,8,["modelValue","onUpdate:modelValue"]),n(o(f),{modelValue:i(s.id).confirm,"onUpdate:modelValue":l=>i(s.id).confirm=l,type:"password",placeholder:"Confirm",class:"sm:w-48"},null,8,["modelValue","onUpdate:modelValue"]),n(o(b),{type:"button",size:"sm",onClick:l=>N(s)},{default:u(()=>[...t[6]||(t[6]=[_(" Update ",-1)])]),_:1},8,["onClick"])]),i(s.id).error?(d(),m("p",de,p(i(s.id).error),1)):c("",!0),g.value===s.id?(d(),m("p",ie," You cannot remove your own admin access. ")):c("",!0)])])]))),128)),w.users.length===0?(d(),m("tr",le,[...t[7]||(t[7]=[e("td",{colspan:"6",class:"px-4 py-8 text-center text-muted-foreground"}," No users found. ",-1)])])):c("",!0)])])])])])]),_:1}))}});export{ze as default};
