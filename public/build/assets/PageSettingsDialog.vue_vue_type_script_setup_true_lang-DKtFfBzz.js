import{d as O,w as N,e as j,f as r,g as i,u as o,j as n,t as _,i as t,N as z,o as m,c as b,n as D,k as F,m as V,v as A,C as B,a as f}from"./app-BM4wth8d.js";import{_ as h}from"./index-BLruGDsa.js";import{_ as R,a as E}from"./DialogContent.vue_vue_type_script_setup_true_lang-BWxvEzB-.js";import{_ as q,a as K,b as L}from"./DialogTitle.vue_vue_type_script_setup_true_lang-DGL_xPNe.js";import{_ as X}from"./DialogFooter.vue_vue_type_script_setup_true_lang-QNjXzNNr.js";import{_ as T}from"./Label.vue_vue_type_script_setup_true_lang-s3Yr3KY0.js";import{u as W}from"./useBookmarksStore-UPt413RC.js";import{X as G}from"./x-w-kZtz8O.js";import{U as H}from"./upload-BZeHSOhz.js";const J={class:"grid gap-4"},Q={class:"grid gap-2"},Y={key:0,class:"relative rounded-lg overflow-hidden border bg-muted aspect-video"},Z=["src"],ee={key:1,class:"relative"},te={class:"text-sm text-muted-foreground"},ae={key:2,class:"text-sm text-destructive"},oe={class:"grid gap-2"},se={class:"flex items-center justify-between"},re={class:"flex w-full items-center justify-between"},ie={key:1},le={class:"flex gap-2"},be=O({__name:"PageSettingsDialog",setup(ne){const{state:a,closePageSettings:k,updatePageSettings:U}=W(),x=B({get:()=>a.isPageSettingsModalOpen,set:l=>{l||k()}}),u=f({background_image:"",background_opacity:100}),v=f(!1),d=f(""),p=f(""),s=f(null),$=B(()=>a.filterType==="favorites"?"Favorites":a.pageMode==="archive"?"Archive":a.pageMode==="trash"?"Trash":"All Bookmarks");N(()=>[a.isPageSettingsModalOpen,a.selectedCollection,a.pageMode,a.filterType,a.userPreferences],()=>{if(a.isPageSettingsModalOpen){let l="all";a.filterType==="favorites"?l="favorites":a.pageMode==="archive"?l="archive":a.pageMode==="trash"&&(l="trash");const e=a.userPreferences.backgrounds?.[l]||{};u.value={background_image:e.background_image||"",background_opacity:e.background_opacity??100},p.value=e.background_image||"",d.value=""}},{immediate:!0});const I=async l=>{const c=l.target.files?.[0];if(!c)return;d.value="";const g=new Image;g.onload=async()=>{if(g.width<1920||g.height<1080){d.value=`Image must be at least 1920x1080 pixels. Current size: ${g.width}x${g.height}`,s.value&&(s.value.value="");return}v.value=!0;const S=new FormData;S.append("image",c);try{const M=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content"),P=await fetch("/bookmarks/upload-image",{method:"POST",body:S,headers:{"X-CSRF-TOKEN":M||"",Accept:"application/json"}}),y=await P.json();if(!P.ok){d.value=y.error||"Upload failed",s.value&&(s.value.value="");return}u.value.background_image=y.url,p.value=y.url}catch{d.value="Upload failed. Please try again.",s.value&&(s.value.value="")}finally{v.value=!1}},g.onerror=()=>{d.value="Invalid image file",s.value&&(s.value.value="")},g.src=URL.createObjectURL(c)},w=()=>{u.value.background_image="",p.value="",s.value&&(s.value.value="")},C=()=>{U(u.value),k()};return(l,e)=>(m(),j(o(E),{open:x.value,"onUpdate:open":e[1]||(e[1]=c=>x.value=c)},{default:r(()=>[i(o(R),{class:"sm:max-w-[425px]"},{default:r(()=>[i(o(q),null,{default:r(()=>[i(o(K),null,{default:r(()=>[...e[2]||(e[2]=[n("Page Settings",-1)])]),_:1}),i(o(L),null,{default:r(()=>[n(' Customize the appearance of your "'+_($.value)+'" view. ',1)]),_:1})]),_:1}),t("form",{onSubmit:z(C,["prevent"]),class:"grid gap-6 py-4"},[t("div",J,[t("div",Q,[i(o(T),{for:"bg-image"},{default:r(()=>[...e[3]||(e[3]=[n("Background Image",-1)])]),_:1}),p.value?(m(),b("div",Y,[t("img",{src:p.value,alt:"Background preview",class:"w-full h-full object-cover"},null,8,Z),t("button",{type:"button",onClick:w,class:"absolute top-2 right-2 p-1.5 rounded-full bg-destructive text-destructive-foreground hover:bg-destructive/90 transition-colors"},[i(o(G),{class:"size-4"})])])):(m(),b("div",ee,[t("input",{ref_key:"fileInput",ref:s,type:"file",id:"bg-image",accept:"image/jpeg,image/png,image/jpg,image/webp",onChange:I,class:"hidden"},null,544),t("label",{for:"bg-image",class:D(["flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer bg-muted/30 hover:bg-muted/50 transition-colors",{"opacity-50 cursor-not-allowed":v.value}])},[i(o(H),{class:"size-8 mb-2 text-muted-foreground"}),t("p",te,_(v.value?"Uploading...":"Click to upload image"),1),e[4]||(e[4]=t("p",{class:"text-xs text-muted-foreground mt-1"}," Min: 1920x1080px â€¢ Max: 5MB ",-1))],2)])),d.value?(m(),b("p",ae,_(d.value),1)):F("",!0),e[5]||(e[5]=t("p",{class:"text-xs text-muted-foreground"},[n(" We recommend "),t("a",{href:"https://www.freepik.com",target:"_blank",class:"underline hover:text-foreground transition-colors"},"Freepik"),n(" for high-quality stock images ")],-1))]),t("div",oe,[t("div",se,[i(o(T),{for:"bg-opacity"},{default:r(()=>[n("Background Opacity ("+_(u.value.background_opacity)+"%)",1)]),_:1})]),V(t("input",{id:"bg-opacity",type:"range","onUpdate:modelValue":e[0]||(e[0]=c=>u.value.background_opacity=c),min:"0",max:"100",step:"1",class:"w-full h-2 bg-muted rounded-lg appearance-none cursor-pointer accent-primary"},null,512),[[A,u.value.background_opacity,void 0,{number:!0}]])])])],32),i(o(X),null,{default:r(()=>[t("div",re,[u.value.background_image?(m(),j(o(h),{key:0,type:"button",variant:"outline",onClick:w,class:"text-destructive hover:text-destructive"},{default:r(()=>[...e[6]||(e[6]=[n(" Remove Image ",-1)])]),_:1})):(m(),b("div",ie)),t("div",le,[i(o(h),{type:"button",variant:"outline",onClick:o(k)},{default:r(()=>[...e[7]||(e[7]=[n(" Cancel ",-1)])]),_:1},8,["onClick"]),i(o(h),{type:"submit",onClick:C},{default:r(()=>[...e[8]||(e[8]=[n(" Save Changes ",-1)])]),_:1})])])]),_:1})]),_:1})]),_:1},8,["open"]))}});export{be as _};
