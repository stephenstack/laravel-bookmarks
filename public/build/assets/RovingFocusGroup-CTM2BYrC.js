import{a as B,g as h,c as D}from"./Presence-DsGFcCQD.js";import{a as p,q as w,a6 as U,a7 as $,d as T,a5 as k,ad as G,z as y,w as L,E as V,o as j,e as z,f as R,g as K,u as b,r as Y}from"./app-Cnu1gOwx.js";import{S as _,P as H}from"./Primitive-DjESCHKf.js";import{u as J,a as Q}from"./index-C95YMyaC.js";function W(e){const o=B({dir:p("ltr")});return w(()=>e?.value||o.dir?.value||"ltr")}function x(){const e=p(),o=w(()=>["#text","#comment"].includes(e.value?.$el.nodeName)?e.value?.$el.nextElementSibling:J(e));return{primitiveElement:e,currentElement:o}}const M="data-reka-collection-item";function X(e={}){const{key:o="",isProvider:u=!1}=e,t=`${o}CollectionProvider`;let r;if(u){const a=p(new Map);r={collectionRef:p(),itemMap:a},U(t,r)}else r=$(t);const F=(a=!1)=>{const n=r.collectionRef.value;if(!n)return[];const i=Array.from(n.querySelectorAll(`[${M}]`)),s=Array.from(r.itemMap.value.values()).sort((f,v)=>i.indexOf(f.ref)-i.indexOf(v.ref));return a?s:s.filter(f=>f.ref.dataset.disabled!=="")},A=T({name:"CollectionSlot",inheritAttrs:!1,setup(a,{slots:n,attrs:i}){const{primitiveElement:d,currentElement:s}=x();return L(s,()=>{r.collectionRef.value=s.value}),()=>y(_,{ref:d,...i},n)}}),C=T({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(a,{slots:n,attrs:i}){const{primitiveElement:d,currentElement:s}=x();return k(f=>{if(s.value){const v=G(s.value);r.itemMap.value.set(v,{ref:s.value,value:a.value}),f(()=>r.itemMap.value.delete(v))}}),()=>y(_,{...i,[M]:"",ref:d},n)}}),S=w(()=>Array.from(r.itemMap.value.values())),g=w(()=>r.itemMap.value.size);return{getItems:F,reactiveItems:S,itemMapSize:g,CollectionSlot:A,CollectionItem:C}}const Z="rovingFocusGroup.onEntryFocus",ee={bubbles:!1,cancelable:!0},te={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function oe(e,o){return o!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ce(e,o,u){const t=oe(e.key,u);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(t))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(t)))return te[t]}function re(e,o=!1){const u=h();for(const t of e)if(t===u||(t.focus({preventScroll:o}),h()!==u))return}function de(e,o){return e.map((u,t)=>e[(o+t)%e.length])}const[fe,ne]=D("RovingFocusGroup");var ae=T({__name:"RovingFocusGroup",props:{orientation:{type:String,required:!1,default:void 0},dir:{type:String,required:!1},loop:{type:Boolean,required:!1,default:!1},currentTabStopId:{type:[String,null],required:!1},defaultCurrentTabStopId:{type:String,required:!1},preventScrollOnEntryFocus:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["entryFocus","update:currentTabStopId"],setup(e,{expose:o,emit:u}){const t=e,r=u,{loop:F,orientation:A,dir:C}=V(t),S=W(C),g=Q(t,"currentTabStopId",r,{defaultValue:t.defaultCurrentTabStopId,passive:t.currentTabStopId===void 0}),a=p(!1),n=p(!1),i=p(0),{getItems:d,CollectionSlot:s}=X({isProvider:!0});function f(l){const m=!n.value;if(l.currentTarget&&l.target===l.currentTarget&&m&&!a.value){const E=new CustomEvent(Z,ee);if(l.currentTarget.dispatchEvent(E),r("entryFocus",E),!E.defaultPrevented){const I=d().map(c=>c.ref).filter(c=>c.dataset.disabled!==""),P=I.find(c=>c.getAttribute("data-active")===""),O=I.find(c=>c.getAttribute("data-highlighted")===""),q=I.find(c=>c.id===g.value),N=[P,O,q,...I].filter(Boolean);re(N,t.preventScrollOnEntryFocus)}}n.value=!1}function v(){setTimeout(()=>{n.value=!1},1)}return o({getItems:d}),ne({loop:F,dir:S,orientation:A,currentTabStopId:g,onItemFocus:l=>{g.value=l},onItemShiftTab:()=>{a.value=!0},onFocusableItemAdd:()=>{i.value++},onFocusableItemRemove:()=>{i.value--}}),(l,m)=>(j(),z(b(s),null,{default:R(()=>[K(b(H),{tabindex:a.value||i.value===0?-1:0,"data-orientation":b(A),as:l.as,"as-child":l.asChild,dir:b(S),style:{outline:"none"},onMousedown:m[0]||(m[0]=E=>n.value=!0),onMouseup:v,onFocus:f,onBlur:m[1]||(m[1]=E=>a.value=!1)},{default:R(()=>[Y(l.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),pe=ae;export{pe as R,x as a,W as b,re as f,ce as g,fe as i,X as u,de as w};
