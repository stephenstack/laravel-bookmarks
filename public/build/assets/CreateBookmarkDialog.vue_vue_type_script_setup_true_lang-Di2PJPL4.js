import{d as P,w as L,P as A,e as _,f as n,g as i,u as a,j as u,t as p,i as o,O as q,o as d,k as f,c as m,m as T,F as z,l as N,Q as G,v as K,R as W,n as R,S as Q,q as U,a as k,p as Y,s as $}from"./app-Cnu1gOwx.js";import{_ as V}from"./index-ZhNFNWlx.js";import{_ as Z,a as H}from"./DialogContent.vue_vue_type_script_setup_true_lang-BRP34PkQ.js";import{_ as J,a as X,b as ee}from"./DialogTitle.vue_vue_type_script_setup_true_lang-Crk5yDdn.js";import{_ as ae}from"./DialogFooter.vue_vue_type_script_setup_true_lang-DLXKOOgf.js";import{_ as y}from"./Input.vue_vue_type_script_setup_true_lang-BjujaZ9W.js";import{_ as c}from"./Label.vue_vue_type_script_setup_true_lang-mTSbsMtz.js";import{u as le}from"./useBookmarksStore-CqZ8Hg9i.js";import{g as te}from"./colors-DpnboA01.js";import{W as oe}from"./wand-sparkles-CyYsSBe9.js";import{L as ie}from"./loader-circle-BoSQ0lUE.js";import{P as se}from"./plus-DCRnZunc.js";import{C as I}from"./check-CpI5L1pJ.js";const re={class:"grid gap-2"},ne={class:"flex gap-2"},de={class:"grid gap-2"},ue={class:"grid grid-cols-2 gap-4"},me={class:"grid gap-2"},ce={class:"grid gap-2"},pe={key:0,class:"relative aspect-video w-full rounded-lg overflow-hidden border"},ve=["src"],ge={class:"absolute inset-x-0 bottom-0 p-3 bg-gradient-to-t from-black/80 to-transparent text-white"},fe={class:"font-bold text-sm truncate"},be={class:"text-[10px] opacity-80 truncate"},_e={class:"grid gap-2"},ke=["disabled"],ye=["value"],we={class:"grid gap-2"},xe=["disabled"],he={class:"grid gap-2"},Ce={class:"flex items-center justify-between"},Be={key:0,class:"space-y-3 p-3 border rounded-lg bg-muted/30 animate-in fade-in slide-in-from-top-2 duration-200"},Ve={class:"space-y-1.5"},Se={class:"flex gap-2"},Te={class:"space-y-1.5"},ze={class:"grid grid-cols-6 gap-2 pt-1"},Ne=["onClick"],Ue={class:"flex flex-wrap gap-2 pt-1"},$e=["value","disabled"],Me={key:0,class:"text-xs text-muted-foreground italic px-1"},Qe=P({__name:"CreateBookmarkDialog",setup(Fe){const{state:r,closeBookmarkModal:b}=le(),M=U({get:()=>r.isBookmarkModalOpen,set:s=>{s||b()}}),w=U(()=>!!r.editingBookmark),l=k({title:"",url:"",collection_id:"all",description:"",favicon:"",image_url:"",tags:[]}),x=k(!1),j=async()=>{if(l.value.url){x.value=!0;try{const e=(await Y.post("/bookmarks/interrogate-url",{url:l.value.url})).data;l.value.title=e.title||l.value.title,l.value.description=e.description||l.value.description,l.value.favicon=e.favicon||l.value.favicon,l.value.image_url=e.image_url||l.value.image_url,C()}catch(s){console.error("Interrogation failed:",s)}finally{x.value=!1}}},v=k(!1),g=k(""),h=k("blue"),O=[{name:"Slate",value:"slate",preview:"bg-slate-500"},{name:"Gray",value:"gray",preview:"bg-gray-500"},{name:"Zinc",value:"zinc",preview:"bg-zinc-500"},{name:"Neutral",value:"neutral",preview:"bg-neutral-500"},{name:"Stone",value:"stone",preview:"bg-stone-500"},{name:"Dark",value:"dark",preview:"bg-zinc-900"},{name:"Red",value:"red",preview:"bg-red-500"},{name:"Orange",value:"orange",preview:"bg-orange-500"},{name:"Amber",value:"amber",preview:"bg-amber-500"},{name:"Yellow",value:"yellow",preview:"bg-yellow-400"},{name:"Lime",value:"lime",preview:"bg-lime-500"},{name:"Green",value:"green",preview:"bg-green-500"},{name:"Emerald",value:"emerald",preview:"bg-emerald-500"},{name:"Teal",value:"teal",preview:"bg-teal-500"},{name:"Cyan",value:"cyan",preview:"bg-cyan-500"},{name:"Sky",value:"sky",preview:"bg-sky-500"},{name:"Blue",value:"blue",preview:"bg-blue-500"},{name:"Indigo",value:"indigo",preview:"bg-indigo-500"},{name:"Violet",value:"violet",preview:"bg-violet-500"},{name:"Purple",value:"purple",preview:"bg-purple-500"},{name:"Fuchsia",value:"fuchsia",preview:"bg-fuchsia-500"},{name:"Pink",value:"pink",preview:"bg-pink-500"},{name:"Rose",value:"rose",preview:"bg-rose-500"},{name:"Maroon",value:"maroon",preview:"bg-red-900"}],D=U(()=>r.collections);L(()=>r.editingBookmark,s=>{s?l.value={title:s.title,url:s.url,collection_id:s.collection_id?String(s.collection_id):"all",description:s.description||"",favicon:s.favicon||"",image_url:s.image_url||"",tags:s.tags?s.tags.map(e=>Number(e.id)):[]}:l.value={title:"",url:"",collection_id:"all",description:"",favicon:"",image_url:"",tags:[]}},{immediate:!0});const C=()=>{const s={...l.value,collection_id:l.value.collection_id==="all"?null:l.value.collection_id,tags:l.value.tags};if(w.value&&r.editingBookmark){if(r.editingBookmark.is_company){b();return}$.put(`/bookmarks/${r.editingBookmark.id}`,s,{onSuccess:()=>b()})}else $.post("/bookmarks",s,{onSuccess:()=>b()})},F=()=>{if(!g.value.trim())return;const s=g.value.trim();$.post("/tags",{name:s,color:h.value},{onSuccess:()=>{v.value=!1,g.value="";const e=L(()=>r.tags,S=>{const t=S.find(B=>B.name===s);t&&!l.value.tags.includes(Number(t.id))&&(l.value.tags.push(Number(t.id)),e())},{deep:!0});setTimeout(e,2e3)},preserveScroll:!0})},E=()=>{v.value=!v.value,v.value||(g.value="")};return(s,e)=>{const S=A("Trash2");return d(),_(a(H),{open:M.value,"onUpdate:open":e[9]||(e[9]=t=>M.value=t)},{default:n(()=>[i(a(Z),{class:"sm:max-w-[425px]"},{default:n(()=>[i(a(J),null,{default:n(()=>[i(a(X),null,{default:n(()=>[u(p(w.value?"Edit Bookmark":"Add Bookmark"),1)]),_:1}),i(a(ee),null,{default:n(()=>[u(p(w.value?"Make changes to your bookmark here.":"Add a new bookmark to your collection."),1)]),_:1})]),_:1}),o("form",{onSubmit:q(C,["prevent"]),class:"grid gap-4 py-4"},[o("div",re,[i(a(c),{htmlFor:"url"},{default:n(()=>[...e[10]||(e[10]=[u("URL",-1)])]),_:1}),o("div",ne,[i(a(y),{id:"url",modelValue:l.value.url,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value.url=t),placeholder:"https://example.com",required:"",disabled:a(r).editingBookmark?.is_company},null,8,["modelValue","disabled"]),a(r).editingBookmark?.is_company?f("",!0):(d(),_(a(V),{key:0,type:"button",variant:"secondary",size:"icon",onClick:j,disabled:x.value},{default:n(()=>[x.value?(d(),_(a(ie),{key:1,class:"size-4 animate-spin"})):(d(),_(a(oe),{key:0,class:"size-4"}))]),_:1},8,["disabled"]))])]),o("div",de,[i(a(c),{htmlFor:"title"},{default:n(()=>[...e[11]||(e[11]=[u("Title",-1)])]),_:1}),i(a(y),{id:"title",modelValue:l.value.title,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.title=t),placeholder:"My Awesome Bookmark",required:"",disabled:a(r).editingBookmark?.is_company},null,8,["modelValue","disabled"])]),o("div",ue,[o("div",me,[i(a(c),null,{default:n(()=>[...e[12]||(e[12]=[u("Favicon URL",-1)])]),_:1}),i(a(y),{modelValue:l.value.favicon,"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.favicon=t),placeholder:"Icon URL",disabled:a(r).editingBookmark?.is_company},null,8,["modelValue","disabled"])]),o("div",ce,[i(a(c),null,{default:n(()=>[...e[13]||(e[13]=[u("Image URL",-1)])]),_:1}),i(a(y),{modelValue:l.value.image_url,"onUpdate:modelValue":e[3]||(e[3]=t=>l.value.image_url=t),placeholder:"Background/OG Image",disabled:a(r).editingBookmark?.is_company},null,8,["modelValue","disabled"])])]),l.value.image_url?(d(),m("div",pe,[o("img",{src:l.value.image_url,class:"w-full h-full object-cover"},null,8,ve),o("div",ge,[o("div",fe,p(l.value.title),1),o("div",be,p(l.value.description),1)]),a(r).editingBookmark?.is_company?f("",!0):(d(),m("button",{key:0,type:"button",onClick:e[4]||(e[4]=t=>{l.value.image_url="",C()}),class:"absolute top-2 right-2 size-7 flex items-center justify-center rounded-full bg-black/50 hover:bg-destructive text-white transition-colors backdrop-blur-sm shadow-md",title:"Remove Image"},[i(S,{class:"size-3.5"})]))])):f("",!0),o("div",_e,[i(a(c),{htmlFor:"collection"},{default:n(()=>[...e[14]||(e[14]=[u("Collection",-1)])]),_:1}),T(o("select",{id:"collection","onUpdate:modelValue":e[5]||(e[5]=t=>l.value.collection_id=t),class:"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background text-foreground px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50",disabled:a(r).editingBookmark?.is_company},[e[15]||(e[15]=o("option",{value:"all",class:"bg-background text-foreground"},"Unorganized",-1)),(d(!0),m(z,null,N(D.value,t=>(d(),m("option",{key:t.id,value:String(t.id),class:"bg-background text-foreground"},p(t.name),9,ye))),128))],8,ke),[[G,l.value.collection_id]])]),o("div",we,[i(a(c),{htmlFor:"description"},{default:n(()=>[...e[16]||(e[16]=[u("Description",-1)])]),_:1}),T(o("textarea",{id:"description","onUpdate:modelValue":e[6]||(e[6]=t=>l.value.description=t),placeholder:"Optional description...",class:"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",disabled:a(r).editingBookmark?.is_company},null,8,xe),[[K,l.value.description]])]),o("div",he,[o("div",Ce,[i(a(c),null,{default:n(()=>[...e[17]||(e[17]=[u("Tags",-1)])]),_:1}),a(r).editingBookmark?.is_company?f("",!0):(d(),m("button",{key:0,type:"button",onClick:E,class:"text-[10px] font-medium text-primary hover:underline flex items-center gap-0.5"},[i(a(se),{class:"size-3"}),u(" "+p(v.value?"Cancel":"New Tag"),1)]))]),v.value?(d(),m("div",Be,[o("div",Ve,[i(a(c),{class:"text-[10px] uppercase tracking-wider opacity-60"},{default:n(()=>[...e[18]||(e[18]=[u("Tag Name",-1)])]),_:1}),o("div",Se,[i(a(y),{modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=t=>g.value=t),placeholder:"Enter tag name...",class:"h-8 text-xs",onKeyup:W(F,["enter"])},null,8,["modelValue"]),i(a(V),{size:"sm",class:"h-8 px-2",onClick:F,disabled:!g.value},{default:n(()=>[i(a(I),{class:"size-3"})]),_:1},8,["disabled"])])]),o("div",Te,[i(a(c),{class:"text-[10px] uppercase tracking-wider opacity-60"},{default:n(()=>[...e[19]||(e[19]=[u("Color",-1)])]),_:1}),o("div",ze,[(d(),m(z,null,N(O,t=>o("button",{key:t.value,type:"button",onClick:B=>h.value=t.value,class:R(["size-7 rounded-full border transition-all flex items-center justify-center shadow-sm mx-auto",[t.preview,h.value===t.value?"ring-2 ring-primary ring-offset-2":"hover:scale-110"]])},[h.value===t.value?(d(),_(a(I),{key:0,class:"size-3.5 text-white"})):f("",!0)],10,Ne)),64))])])])):f("",!0),o("div",Ue,[(d(!0),m(z,null,N(a(r).tags,t=>(d(),m("label",{key:t.id,class:R(["flex items-center gap-1.5 px-2 py-1 rounded-md border text-xs cursor-pointer transition-colors",[l.value.tags.includes(Number(t.id))?"bg-primary border-primary text-primary-foreground":[a(te)(t.color),"hover:opacity-80"],a(r).editingBookmark?.is_company?"cursor-not-allowed opacity-80":""]])},[T(o("input",{type:"checkbox",value:Number(t.id),"onUpdate:modelValue":e[8]||(e[8]=B=>l.value.tags=B),class:"hidden",disabled:a(r).editingBookmark?.is_company},null,8,$e),[[Q,l.value.tags]]),o("span",null,p(t.name),1)],2))),128)),a(r).tags.length===0&&!v.value?(d(),m("div",Me," No tags created yet. ")):f("",!0)])])],32),i(a(ae),null,{default:n(()=>[i(a(V),{type:"button",variant:"outline",onClick:a(b)},{default:n(()=>[...e[20]||(e[20]=[u(" Cancel ",-1)])]),_:1},8,["onClick"]),i(a(V),{type:"submit",onClick:C},{default:n(()=>[u(p(w.value?"Save Changes":"Create Bookmark"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])}}});export{Qe as _};
