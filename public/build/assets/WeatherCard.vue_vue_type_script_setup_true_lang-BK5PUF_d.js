import{W as p,C as k,a as S,b as D}from"./wind-BZughYNe.js";import{S as _}from"./sun-YnuQTg5V.js";import{d as b,z as I,c,i as o,e as W,I as N,t as i,g as z,u as B,k as $,a as h,C as v,o as n}from"./app-BM4wth8d.js";const E={class:"flex items-center gap-4 rounded-xl border bg-card p-4 cursor-pointer hover:bg-accent/50 transition-colors h-[88px]"},F={class:"flex size-10 items-center justify-center rounded-lg bg-sky-500/10 text-sky-500"},M={class:"flex-1"},O={key:0,class:"text-2xl font-bold"},R={key:1,class:"text-2xl font-bold text-destructive"},V={key:2,class:"text-2xl font-bold"},j={class:"text-sm text-muted-foreground"},A={key:0,class:"flex flex-col items-end gap-0.5 text-xs text-muted-foreground"},J={class:"flex items-center gap-1"},L=900*1e3,U=b({__name:"WeatherCard",props:{city:{},latitude:{},longitude:{}},setup(f){const r=f,a=h(null),l=h(!1),s=h(""),w=v(()=>{if(!a.value)return _;const e=a.value.weatherCode;return e===0?_:e>=1&&e<=3?k:e>=51&&e<=67?S:e>=71&&e<=77?D:p}),g=v(()=>{if(!a.value)return"Loading...";const e=a.value.weatherCode;return e===0?"Clear":e>=1&&e<=3?"Cloudy":e>=51&&e<=67?"Rainy":e>=71&&e<=77?"Snowy":"Windy"}),d=()=>`weather_${r.latitude}_${r.longitude}`,x=()=>{try{const e=localStorage.getItem(d());if(!e)return null;const t=JSON.parse(e);return Date.now()-t.timestamp<L?t:(localStorage.removeItem(d()),null)}catch{return null}},y=e=>{try{const t={...e,timestamp:Date.now()};localStorage.setItem(d(),JSON.stringify(t))}catch(t){console.error("Failed to cache weather data:",t)}},C=async()=>{if(!r.latitude||!r.longitude){s.value="Location not set";return}const e=x();if(e){a.value=e;return}l.value=!0,s.value="";try{const t=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${r.latitude}&longitude=${r.longitude}&current=temperature_2m,weather_code,wind_speed_10m&temperature_unit=celsius`);if(!t.ok)throw new Error("Failed to fetch weather");const u=await t.json(),m={temperature:Math.round(u.current.temperature_2m),weatherCode:u.current.weather_code,windSpeed:Math.round(u.current.wind_speed_10m)};a.value={...m,timestamp:Date.now()},y(m)}catch(t){s.value="Failed to load weather",console.error("Weather fetch error:",t)}finally{l.value=!1}};return I(()=>{C()}),(e,t)=>(n(),c("div",E,[o("div",F,[(n(),W(N(w.value),{class:"size-5"}))]),o("div",M,[l.value?(n(),c("p",O,"--°")):s.value?(n(),c("p",R,"!")):(n(),c("p",V,i(a.value?.temperature)+"°C",1)),o("p",j,i(f.city||"Weather"),1)]),a.value&&!l.value&&!s.value?(n(),c("div",A,[o("div",J,[z(B(p),{class:"size-3"}),o("span",null,i(a.value.windSpeed)+" km/h",1)]),o("div",null,i(g.value),1)])):$("",!0)]))}});export{U as _};
